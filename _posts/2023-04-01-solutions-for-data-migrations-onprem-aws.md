---
layout: post
title:  "Solutions for migrating unstructured data from On-prem to AWS"
date:   2023-04-01 21:36:04 +0530
tags: migrations data aws featured
authors: 
  - Santhosh
  - Rakesh
read_time: true
classes: wide
image: /assets/images/growtika-ahgsuFHlIFo-unsplash.jpg
---



During Cloud Migrations, we come across scenarios where there is a need to migrate or transfer files that are typically unstructured data, from on-premises (SAN/NAS) to a specific storage service in AWS(EBS/EFS/S3/FSx). These can be files generated by the application, user uploads, integration files that are created by one application and consumed by others(B2B) etc. In most cases these unstructured data may vary in total size from a few MBs to 1 TB and most importantly, the underlying application is not expected to undergo a lot of remediation to utilize the target AWS service.

In this blog, we share our experience with three specific use cases around unstructured data migration to AWS. 

In the first scenario, where the requirement is to share data among multiple VMs/Applications, we describe how unstructured data from a Network Attached Storage (NAS) was migrated to AWS. In the second scenario, we will talk about how we migrated B2B data to AWS Storage. Finally, where the unstructured data existed in the native file system (NTFS, xfs or ext4) and not exposed to the network as a File Share, we will discuss about how the data in Windows/Linux instances was migrated to AWS.



## 1.	From Network Attached Storage to AWS using AWS DataSync

### Problem/Scenario
Application A picks up incoming files from an Application X, processes it and generates data files of size 50GB - 300 GB and that becomes the input for another Application Y to consume. The data is shared by means of an NFS Storage accessible to all three applications. Application A is being migrated to AWS and the Applications X and Y continue to remain on-premises. We used AWS Elastic File System (EFS) to replace NFS on AWS. However, that makes it difficult for the applications to read/write from a common storage solution and network latency slows down Application X and Application Y
### Solution
In this case, we used AWS DataSync Service to perform Initial Migration of nearly 1 TB of data from the On-Premises NFS storage to AWS EFS.
AWS DataSync can transfer data between any two Network or Object Storage. These are Network File Systems (NFS), Server Message Block (SMB) file servers, Hadoop Distributed File Systems (HDFS), self-managed object storage, AWS Snowcone, Amazon Simple Storage Service (Amazon S3) buckets, Amazon Elastic File System (Amazon EFS) file systems, Amazon FSx for Windows File Server file systems, Amazon FSx for Lustre file systems, and Amazon FSx for OpenZFS file systems.

{% include figure image_path="/assets/images/data-sync.png" alt="AWS Data Sync" caption="Migrating data using AWS Data Sync" style="display: block; margin: 0 auto" %}

To solve the need for the applications to read/write from a common storage solution and address the network latency involved during read/write operations across the Direct Connect, we scheduled a regular synchronization of the specific input and output folders using AWS DataSync service between the NFS and EFS, so that all three applications look at same set of files after the sync is complete.
### Challenges
<li>
Syncs can be scheduled at minimum 1-hour intervals. This soft limit can be modified for up to 15-minutes intervals, however, that leads to performance issues and subsequent sync schedules getting queued up forming a loop.
Bidirectional Syncs were configured to run in a queued fashion, that is, only one way sync can be executed at a time. Applications will have to read the files after the sync interval is completed. Since in our case, files are generated only one time per day, this challenge was mitigated by scheduling the read/writes in a timely fashion.
</li>
### Cost implications
<li>
No fixed/upfront cost and only $0.0125 per gigabyte (GB) for data transferred
AWS DataSync Agent (virtual appliance) to be installed on a dedicated VM at on-premises
</li>

